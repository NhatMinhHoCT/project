<!DOCTYPE html>
<html>

<head>
  <title>Seat Booking</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <div class="container">
    <h1>Seat Booking</h1>
    <div class="row">
      <div class="col-md-6">
        <table>
          <tbody>
            <!-- Generate table rows using a for loop -->
            <script>
              const numRows = 6;
              const numCols = 3;
              const bookedSeats = ["A1", "A3", "A4"];

              for (let row = 0; row < numRows; row++) {
                const tr = document.createElement('tr');

                for (let col = 0; col < numCols; col++) {
                  const td = document.createElement('td');
                  const seatId = `A${row * numCols + col + 1}`;

                  if (row === 0 && col === 1) {
                    // Empty cell in the first row, middle column
                    td.innerHTML = '';
                  } else {
                    const span = document.createElement('span');
                    span.id = seatId;
                    span.classList.add('btn', 'btn-outline-primary');
                    span.textContent = seatId;
                    td.appendChild(span);
                  }

                  tr.appendChild(td);
                }

                document.querySelector('tbody').appendChild(tr);
              }

              // Get all seat elements
              const seatElements = document.querySelectorAll('span.btn');

              // Loop through each seat element
              seatElements.forEach(seat => {
                const seatId = seat.id;

                // Check if the seat is booked
                if (bookedSeats.includes(seatId)) {
                  // Change the class and disable the seat
                  seat.classList.remove('btn-outline-primary');
                  seat.classList.add('btn-dark');
                  seat.disabled = true;
                } else {
                  // Add click event listener for available seats
                  seat.addEventListener('click', () => {
                    alert(`You selected seat ${seatId}`);
                  });
                }
              });
            </script>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>

</html>

To link the main.js file located in the resources/js folder from your Blade file inside the views folder, you can use the asset helper function provided by Laravel. Here's how you can do it:

First, make sure that the main.js file is included in the resources/js/app.js file. This is necessary because Laravel's asset pipeline compiles and bundles all JavaScript files referenced in app.js.
In resources/js/app.js, add the following line:

import './main.js';



In your Blade file (e.g., resources/views/your-view.blade.php), you can link the compiled JavaScript file using the asset helper function:
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your View</title>
</head>
<body>
    <!-- Your HTML content -->

    <!-- Link the compiled JavaScript file -->
    <script src="{{ asset('js/app.js') }}"></script>
</body>
</html>



The asset helper function generates the correct URL for the compiled JavaScript file based on your application's public path.

Make sure to run the following command to compile your JavaScript assets:
npm run dev



This command will compile your JavaScript files, including main.js, and create the public/js/app.js file, which you can then link in your Blade file.

After following these steps, your main.js file will be included in the compiled app.js file, and you can access its functionality in your Blade view.

Note that if you make changes to your JavaScript files, you'll need to re-run the npm run dev command to recompile the assets and see the changes reflected in your application.



Try again with different context
Add context...
Avatar for honhatminh1510-cfizq



To count the active schedules for a specific date in Laravel Eloquent, you can use a query with a whereNotExists subquery to exclude the schedules that have a cancellation record for the given date.

Here's an example of how you can do it:

use Illuminate\Support\Carbon;

$date = Carbon::parse('2024-06-24'); // Replace with the desired date

$activeSchedulesCount = \App\Models\Schedule::whereNotExists(function ($query) use ($date) {
    $query->select('schedule_id')
          ->from('schedule_cancels')
          ->whereRaw('? BETWEEN start_cancel AND end_cancel', [$date->toDateString()])
          ->whereColumn('schedule_cancels.schedule_id', 'schedules.id');
})->count();



Let's break down the code:

First, we create a Carbon instance with the desired date using Carbon::parse('2024-06-24').

Then, we use the whereNotExists method on the Schedule model to exclude schedules that have a cancellation record for the given date.

Inside the whereNotExists closure, we define a subquery that selects the schedule_id from the schedule_cancels table where the given date falls between the start_cancel and end_cancel dates.

We use the whereRaw method to construct a raw SQL condition that checks if the given date is between start_cancel and end_cancel. The ? placeholder is used to bind the date value.

We also add a whereColumn condition to match the schedule_id from the schedule_cancels table with the id column in the schedules table.

Finally, we call the count() method on the main query to get the count of active schedules.

The resulting $activeSchedulesCount variable will contain the count of active schedules for the specified date.

Note: Make sure to replace \App\Models\Schedule with the actual namespace and class name of your Schedule model. Also, adjust the table and column names according to your database schema.
$query = Ticket::join('schedules', 'tickets.schedule_id', '=', 'schedules.id')
                ->join('roads', 'schedules.road_id', '=', 'roads.id');

// Filter by start_point
if ($request->has('start_point')) {
    $query->where('roads.start_point', $request->input('start_point'));
}

// Filter by end_point
if ($request->has('end_point')) {
    $query->where('roads.end_point', $request->input('end_point'));
}

// Filter by date_of_depart
if ($request->has('date')) {
    $query->whereDate('tickets.date_of_depart', $request->input('date'));
}

// Filter by ticketcount (assuming you want to check for available seats)
if ($request->has('ticketcount')) {
    $query->havingRaw('COUNT(tickets.id) < ?', [$request->input('ticketcount')]);
}

$results = $query->select('roads.start_point', 'roads.end_point', 'roads.duration', 'schedules.departure_time', 'tickets.date_of_depart')
                  ->groupBy('schedules.id', 'tickets.date_of_depart')
                  ->get();
